<html>
<title>Slack Shell</title>
<body>
<div class="ramadda-section">
<center><a href="${urlroot}/slack/index.html">Slack Documentation</a></center>
<h2>Slack Shell</h2>

The RAMADDA Slack Shell lets you access content and  data in your RAMADDA site directly from Slack. 
<br><p>

To set this up  -

<ol>
<li> Create a Slack Slash Command. In Slack go to the Integrations page for your team. Under Configured Integrations select Slash Commands and add a new Slash Commands integration. You can choose any command (I've used "/r" or "/ramadda"). 

<li> To configure this Slash Command enter your RAMADDA URL  - 
<a href="https://${hostname}${urlroot}//slack/api">https://${hostname}${urlroot}/slack/api</a>
- in the Configuration page. 
<center><img src="images/slashcommand.png" width="500"></center>

<li> Before Saving the command copy the Token,  we'll use it to configure things on the RAMADDA side.
</ol>


<br>

Now, go to your RAMADDA repository and log in as an admin. You will create a RAMADDA Slack Harvester.
<ol>

<li> Under the Admin-&gt;Harvesters page add a New Harvester and select  Slack Harvester. 

<li> Open up the Run Settings and check on "Active on Start Up". This will enable this harvester.

<li> Now, copy the token you got from Slack into the harvester tokens field. You can have any number of Slash commands that point to this single harvester.

<li> Select the area in RAMADDA you want to provide access to. Under the Base Folder select a RAMADDA entry. 

<li> The Slack Incoming Web Hook URL is the way that RAMADDA can talk back to Slack. 
<br>
To enable this go back to your Slack Team. Under the Integrations page create an Incoming Web Hook and copy the URL that Slack provides into the RAMADDA harvester. 


<li> The Slack API Token allows RAMADDA to publish files back to Slack. 
Go the Slack's   <a href="https://api.slack.com/web" target="_other">Web API</a> page and copy the API token to the RAMADDA Harvester.

<li> Save the Slack Harvester and you should be good to go. 
</ol>



<a name="commands"></a>
<h3>Slack Shell Commands</h3>
You can do a number of things in RAMADDA through Slack. 
<p>
Search:
<pre>
/r search some search text
</pre>
<br>

The interface lets you navigate around RAMADDA like a command line:
<pre>
#Show the current entry 
/r pwd

#List the sub-entries of the current entry
/r ls

#change directory to a sub folder
/r cd some folder

#change directory to the top-level entry
/r cd

#cd up a couple
/r cd ../..
</pre>

You can enter multiple commands on one line separated by a semi-colon:
<pre>
/r pwd; ls; cd;
</pre>

<br>


<a name="new"></a>
Create wiki pages, web logs and other entries
<pre>
/r new &lt;folder or wiki or blog or note&gt; New entry name | Optional description or wiki text
</pre>


<p>
You can also define a slash command that has the RAMADDA command predefined. So you can add a slash command, e.g. "/cd", that maps to the URL:
<pre>
<a href="https://${hostname}${urlroot}/slack/slack/api">https://${hostname}${urlroot}/slack/slack/api?ramadda_command=cd</a>
</pre>
Create multiple slash commands, e.g.:
<pre>
<a href="https://${hostname}${urlroot}/slack/slack/api">https://${hostname}${urlroot}/slack/slack/api?ramadda_command=ls</a>
<a href="https://${hostname}${urlroot}/slack/slack/api">https://${hostname}${urlroot}/slack/slack/api?ramadda_command=pwd</a>
<a href="https://${hostname}${urlroot}/slack/slack/api">https://${hostname}${urlroot}/slack/slack/api?ramadda_command=new</a>
</pre>

Now in Slack you would just do:
<pre>
/cd &lt;some_entry&gt;
/ls
/etc
</pre>




<a name="monitors"></a>
<h3>RAMADDA Monitors and Slack Integration</h3>
You can add a monitor to your RAMADDA repository that will post a message to Slack when entries that match certain  search criteria are created.
<p>
Login to your RAMADDA and go to your User Settings-&gt;Monitors page.  Create a new Slack Monitor, specify is valid date range and any search
criteria (e.g.,text, spatial, type). Enter the  Incoming Web Hook URL you get from Slack. A link will be posted to slack when a new entry is created
that meets the search criteria.

</div>


<a name="search"></a>
<h3>Search</h3>

TBD

<a name="tokens"></a>
<h3>Handling API Tokens</h3>

You may end up having a number Slack Harvesters and Slack Team imports where each requires an API token. You can simplify management of the API tokens by adding a properties file to your RAMADDA server home directory. This properties file contains an property that specifies an API token. It may be any name, e.g. 
<pre>
slack.api.token=&lt;tAPI token from Slack&gt;
</pre>

Instead of entering the actual API token in the Harvester or in the Team Entry you can just specify the property, e.g. "slack.api.token" 

</div>
</body>
</html>

