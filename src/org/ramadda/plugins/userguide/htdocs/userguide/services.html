<html>
<head>
<title>Service Integration Framework</title>
  <link rel="stylesheet" type="text/css" href="./default.css" title="Style">

</head>

<body>
<table width=100% cellspacing=0 cellpadding=0 ><tr><td width=30%>
<a href="plugins.html"><img src="images/PreviousArrow.gif" border="0"   alt="Previous: Plugins" title="Previous: Plugins"></a> <a href="templates.html"><img src="images/NextArrow.gif" border="0"   alt="Next: HTML Page Templates" title="Next: HTML Page Templates"></a>  <a href="toc.html#services.html"><img src="images/TOCIcon.gif" border="0"   alt="Table of contents" title="Table of contents"></a>
</td>
<td width=40% align=center>
<div class="pagetitle">RAMADDA User Guide</div>
</td>
<td width=30%>&nbsp;</td>
</tr></table>
<div class="pagetitle">14.4 Service Integration Framework</div>

<style type="text/css">
pre {
    margin-left:15px;
}
</style>





RAMADDA supports 



<a name="run"></a><div class="pagesubtitle">14.4.0 Service XML</div> 
A service is defined in XML and provided to RAMADDA as a plugin. 
There are numerous examples in plugins available
at <a href="http://sourceforge.net/p/ramadda/code/HEAD/tree/src/org/ramadda/">http://sourceforge.net/p/ramadda/code/HEAD/tree/src/org/ramadda/</a>


<pre>
media.pdfbox.path=/Users/jeffmc/.ramadda/bin/pdfbox.sh
</pre>

The most compact way to specify a service is to do it as a output handler xml.
Below is an example. Remove the "_ex1" so you have an outputhandlers.xml plugin file.
<blockquote><pre>&lt;outputhandlers&gt;
<span class="xmlcomment">&lt;!--
We can have any number of outputhandler definitions here
We are specifying the class as org.ramadda.repository.output.ServiceOutputHandler
--&gt;</span>
  &lt;outputhandler <span class="xmlattr">class</span>="org.ramadda.repository.output.ServiceOutputHandler&quot; <span class="xmlattr">category</span>="Test Output&quot;&gt;
<span class="xmlcomment">&lt;!-- This is the service definition. 
Set a property test1.path=/path/to/executable.sh in a .properties file in your RAMADDA home dir --&gt;</span>
    &lt;service <span class="xmlattr">id</span>="test.service1&quot;  <span class="xmlattr">command</span>="${test1.path}&quot; <span class="xmlattr">label</span>="Run example service 1&quot; <span class="xmlattr">icon</span>="/icons/pdf.png&quot; &gt;
    &lt;description&gt;<span class="xmlcdata">&lt;![CDATA[Runs an example service]]&gt;</span>&lt;/description&gt;
<span class="xmlcomment">&lt;!-- Define the command line arguments --&gt;</span>

<span class="xmlcomment">&lt;!-- Always have 'any value' as an arg --&gt;</span>
       &lt;arg <span class="xmlattr">value</span>="any value&quot;/&gt;

<span class="xmlcomment">&lt;!-- specify type='enumeration' for a pull down list. --&gt;</span>
       &lt;arg <span class="xmlattr">name</span>="fruit1&quot; <span class="xmlattr">type</span>="enumeration&quot; <span class="xmlattr">values</span>="apple,banana,orange&quot; <span class="xmlattr">addNone</span>="true&quot;/&gt;

<span class="xmlcomment">&lt;!-- specify value:label pairs --&gt;</span>
       &lt;arg <span class="xmlattr">name</span>="fruit2&quot; <span class="xmlattr">type</span>="enumeration&quot; <span class="xmlattr">values</span>="apple:Apple label,banana:Banana label,orange:Orange label&quot;/&gt;

<span class="xmlcomment">&lt;!-- Specify a value attribute where the macro '${value}' is replaced with the selected value --&gt;</span>
       &lt;arg <span class="xmlattr">name</span>="fruit3&quot; <span class="xmlattr">type</span>="enumeration&quot; <span class="xmlattr">values</span>="apple,banana,orange&quot; <span class="xmlattr">value</span>="fruit=${value}&quot;/&gt;

       &lt;arg <span class="xmlattr">value</span>="${entry.file}&quot; <span class="xmlattr">type</span>="entry&quot; <span class="xmlattr">entryType</span>="type_document_pdf&quot; <span class="xmlattr">primary</span>="true&quot; <span class="xmlattr">label</span>="Input PDF File&quot; &gt;&lt;/arg&gt;
       &lt;arg <span class="xmlattr">value</span>="${file}&quot; <span class="xmlattr">file</span>="${entry.file.base}.txt&quot;&gt;&lt;/arg&gt;
       &lt;output <span class="xmlattr">type</span>="file&quot; <span class="xmlattr">pattern</span>=".*\.txt&quot;/g
       &lt;output <span class="xmlattr">type</span>="type_image&quot; <span class="xmlattr">pattern</span>=".*\.png&quot;/&gt;
    &lt;/service&gt;
  &lt;/outputhandler&gt;

&lt;/outputhandlers&gt;
<a href="examples/outputhandlers_ex1.xml"><img src="folder.gif" border="0">examples/outputhandlers_ex1.xml</a>
</pre></blockquote>

Another way is to define the services in a services.xml file, e.g.:
<blockquote><pre>&lt;services&gt;
<span class="xmlcomment">&lt;!-- This is the service definition. 
Set a property test1.path=/path/to/executable.sh in a .properties file in your RAMADDA home dir 
--&gt;</span>
    &lt;service 
       <span class="xmlattr">id</span>="test_service1&quot;  
       <span class="xmlattr">command</span>="${test.service1.path}&quot; 
       <span class="xmlattr">label</span>="Run example service 1&quot; 
       <span class="xmlattr">icon</span>="/icons/pdf.png&quot; &gt;
    &lt;description&gt;<span class="xmlcdata">&lt;![CDATA[Runs an example service]]&gt;</span>&lt;/description&gt;
<span class="xmlcomment">&lt;!-- Define the command line arguments --&gt;</span>

<span class="xmlcomment">&lt;!--
Each arg tag has the following attributes:
type (string, flag, enumeration, value,int, entry, etc)
name - the url argument id 
value - a value to use - may contain ${...} macros
label
help - shown in the form
values - list of comma separated enum values
prefix - added to the arg list if the value is defined
--&gt;</span>


<span class="xmlcomment">&lt;!-- Always have 'any value' as an arg --&gt;</span>
       &lt;arg <span class="xmlattr">value</span>="any value&quot;/&gt;

<span class="xmlcomment">&lt;!-- specify type='enumeration' for a pull down list. --&gt;</span>
       &lt;arg <span class="xmlattr">name</span>="fruit1&quot; <span class="xmlattr">type</span>="enumeration&quot; <span class="xmlattr">values</span>="apple,banana,orange&quot; <span class="xmlattr">addNone</span>="true&quot;/&gt;

<span class="xmlcomment">&lt;!-- specify value:label pairs --&gt;</span>
       &lt;arg <span class="xmlattr">name</span>="fruit2&quot; <span class="xmlattr">type</span>="enumeration&quot; <span class="xmlattr">values</span>="apple:Apple label,banana:Banana label,orange:Orange label&quot;/&gt;

<span class="xmlcomment">&lt;!-- Specify a value attribute where the macro '${value}' is replaced with the selected value --&gt;</span>
       &lt;arg <span class="xmlattr">name</span>="fruit3&quot; <span class="xmlattr">type</span>="enumeration&quot; <span class="xmlattr">values</span>="apple,banana,orange&quot; <span class="xmlattr">value</span>="fruit=${value}&quot;/&gt;

       &lt;arg <span class="xmlattr">name</span>="length&quot; <span class="xmlattr">type</span>="int&quot; <span class="xmlattr">default</span>="5&quot; <span class="xmlattr">help</span>="Some length&quot; <span class="xmlattr">label</span>="Length&quot;/&gt;

       &lt;arg <span class="xmlattr">name</span>="string1&quot; <span class="xmlattr">type</span>="string&quot; <span class="xmlattr">size</span>="50&quot;  <span class="xmlattr">label</span>="Some string&quot;/&gt;
<span class="xmlcomment">&lt;!--
If the string is defined then also add the prefix as an argument
--&gt;</span>
       &lt;arg <span class="xmlattr">name</span>="string2&quot; <span class="xmlattr">type</span>="string&quot; <span class="xmlattr">size</span>="50&quot;  <span class="xmlattr">label</span>="Some string&quot; <span class="xmlattr">prefix</span>="-string&quot;/&gt;

<span class="xmlcomment">&lt;!-- If checkbox is selected then add the value--&gt;</span>
       &lt;arg <span class="xmlattr">name</span>="flag1&quot; <span class="xmlattr">type</span>="flag&quot;   <span class="xmlattr">label</span>="Some flag&quot; <span class="xmlattr">value</span>="flag1 selected&quot;/&gt;

<span class="xmlcomment">&lt;!-- If checkbox is selected then add the &quot;-someflag&quot; &quot;value&quot; --&gt;</span>
       &lt;arg <span class="xmlattr">name</span>="flag2&quot; <span class="xmlattr">type</span>="flag&quot;   <span class="xmlattr">label</span>="Some flag&quot; <span class="xmlattr">prefix</span>="-someflag&quot; <span class="xmlattr">value</span>="flag1 selected&quot;/&gt;

<span class="xmlcomment">&lt;!-- Args of type entry match up with specific entry types in ramadda --&gt;</span>
       &lt;arg <span class="xmlattr">value</span>="${entry.file}&quot; <span class="xmlattr">type</span>="entry&quot; <span class="xmlattr">entryType</span>="type_document_pdf&quot; <span class="xmlattr">primary</span>="true&quot; <span class="xmlattr">label</span>="Input PDF File&quot; &gt;&lt;/arg&gt;

<span class="xmlcomment">&lt;!--
This uses the macro ${entry.file.base} to get the base name (minus the suffix) of the selected entry's file
So, if we having incoming.pdf the output file is incoming.txt
--&gt;</span>
       &lt;arg <span class="xmlattr">value</span>="${file}&quot; <span class="xmlattr">file</span>="${entry.file.base}.txt&quot;&gt;&lt;/arg&gt;

<span class="xmlcomment">&lt;!--
Now define the outputs. Each output has a regexp pattern that matches on any generated file
You can specify an entry type for the entries that get created for each file
--&gt;</span>
       &lt;output <span class="xmlattr">type</span>="file&quot; <span class="xmlattr">pattern</span>=".*\.txt&quot;/g
       &lt;output <span class="xmlattr">type</span>="type_image&quot; <span class="xmlattr">pattern</span>=".*\.png&quot;/&gt;

<span class="xmlcomment">&lt;!-- If the service produces text to the stdout then this specifies to write to a file --&gt;</span>
    &lt;output <span class="xmlattr">showResults</span>="true&quot; <span class="xmlattr">stdout</span>="true&quot; <span class="xmlattr">filename</span>="test.txt&quot;/&gt;
   
 &lt;/service&gt;
&lt;/services&gt;
<a href="examples/services_ex1.xml"><img src="folder.gif" border="0">examples/services_ex1.xml</a>
</pre></blockquote>

Then have an outputhandlers.xml that references the services:
<blockquote><pre>&lt;outputhandlers <span class="xmlattr">class</span>="org.ramadda.repository.output.ServiceOutputHandler&quot; 
                <span class="xmlattr">icon</span>="/icons/cog.png&quot;&gt;
  &lt;outputhandler <span class="xmlattr">serviceId</span>="bio_hmmer_convert&quot;/&gt;
  &lt;outputhandler <span class="xmlattr">serviceId</span>="bio_hmmer_convert&quot;/&gt;
&lt;/outputhandlers&gt;
<a href="examples/outputhandlers_ex2.xml"><img src="folder.gif" border="0">examples/outputhandlers_ex2.xml</a>
</pre></blockquote>


<a name="configuration"></a><div class="pagesubtitle">14.4.1 Configuration</div> 


<pre>
media.qtools.path=/usr/local/bin
media.pdfbox.path=/Users/jeffmc/.ramadda/bin/pdfbox.sh
media.imagemagick.path=/opt/local/bin


geo.gdal.path=/usr/local/bin


geo.hdf5.path=/opt/local/bin
nco.path=/opt/local/bin
cdo.path=/opt/local/bin/cdo
ncl.ncarg_root=/Users/jeffmc/bin/dummy.sh
ncl.convert.path=/Users/jeffmc/bin/dummy.sh

#MBsystem bathymetry
geo.mb.path=/usr/local/bin

#Bio
bio.dicom.dcm4che=/Users/jeffmc/software/dcm4che-2.0.28/bin
bio.sratools=/Users/jeffmc/software/sratoolkit.2.3.5-2/bin
bio.hmmertools=/Users/jeffmc/software/hmmer-3.1b1-macosx-intel/binaries
bio.picard=/Users/jeffmc/software/picard-tools-1.119/picard.sh
bio.gatk=/Users/jeffmc/software/gatk/gatk.sh
bio.bedtools=/Users/jeffmc/software/bedtools2/bin









<p>

<p>&nbsp;<p>
<a href="plugins.html"><img src="images/PreviousArrow.gif" border="0"   alt="Previous: Plugins" title="Previous: Plugins"></a> <a href="templates.html"><img src="images/NextArrow.gif" border="0"   alt="Next: HTML Page Templates" title="Next: HTML Page Templates"></a>  <a href="toc.html#services.html"><img src="images/TOCIcon.gif" border="0"   alt="Table of contents" title="Table of contents"></a>
<p>

</body>
</html>

